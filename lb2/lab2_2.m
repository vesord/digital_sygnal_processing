% Вычислить свёртку двух сигналов

Fs = 5000;
dt = 1 / Fs;

t = 0:dt:0.5;
y = sin(2 * pi * 25 * t) + 0.5 .* sin(2 * pi * 2000 * t);
h = [0.0000 0.0009 0.0034 0.0072 0.0104 0.0099 0.0047 -0.0021 -0.0054 -0.0031 0.002 0.0043 0.0014 -0.003 -0.0035 0.0004 0.0038 0.0022 -0.0024 -0.004 -0.0003 0.0041 0.0032 -0.0022 -0.005 -0.0012 0.0046 0.0046 -0.0019 -0.0063 -0.0024 0.0053 0.0064 -0.0013 -0.008 -0.0043 0.0059 0.0089 -0.0003 -0.0102 -0.0069 0.0065 0.0124 0.0014 -0.013 -0.0109 0.007 0.0176 0.0045 -0.0172 -0.0177 0.0075 0.0265 0.0105 -0.0248 -0.0316 0.0077 0.0477 0.0271 -0.0474 -0.0834 0.0079 0.204 0.3677 0.3677 0.204 0.0079 -0.0834 -0.0474 0.0271 0.0477 0.0077 -0.0316 -0.0248 0.0105 0.0265 0.0075 -0.0177 -0.0172 0.0045 0.0176 0.007 -0.0109 -0.013 0.0014 0.0124 0.0065 -0.0069 -0.0102 -0.0003 0.0089 0.0059 -0.0043 -0.008 -0.0013 0.0064 0.0053 -0.0024 -0.0063 -0.0019 0.0046 0.0046 -0.0012 -0.005 -0.0022 0.0032 0.0041 -0.0003 -0.004 -0.0024 0.0022 0.0038 0.0004 -0.0035 -0.003 0.0014 0.0043 0.002 -0.0031 -0.0054 -0.0021 0.0047 0.0099 0.0104 0.0072 0.0034 0.0009 0.000];

figure();

%   ---Y---

subplot(2, 2, 1);
plot(t, y, 'Color', 'b');
hold on;
title('y');
xlabel('t, s');
ylabel('A');
grid on;
xlim([0,0.05]);
ylim([-1.6,1.6]);

%   ---H---

t_h = 0:dt:dt * (length(h) - 1);
subplot(2, 2, 2);
plot(t_h, h, 'Color', 'b');
hold on;
title('h');
xlabel('t, s');
ylabel('A');
grid on;
xlim([0, dt * (length(h) - 1)]);
ylim([min(h), max(h)]);

%   ---CONVOLUTION LINEAR---

c_lin = conv(y, h);
t_c_lin = 0:dt:dt * (length(c_lin) - 1);
subplot(2, 2, 3);
plot(t_c_lin, c_lin, 'Color', 'b');
hold on;
title('Свёртка линейная');
xlabel('t, s');
ylabel('A');
grid on;
xlim([0,0.05]);
ylim([min(c_lin),max(c_lin)]);

%   ---CONVOLUTION CIRCLE---

c_cir = conv(y, h, 'valid');
t_c_cir = 0:dt:dt * (length(c_cir) - 1);
subplot(2, 2, 4);
plot(t_c_cir, c_cir, 'Color', 'b');
hold on;
title('Свёртка циклическая');
xlabel('t, s');
ylabel('A');
grid on;
xlim([0,0.05]);
ylim([min(c_cir),max(c_cir)]);

